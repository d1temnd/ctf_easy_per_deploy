# easy_per_deploy

Проект представлен для простого развертывания задач ctf где участники могут нанести урон основному контейнеру
и помешать решать задачи другим участникам 

## Для кого этот проект

Проект подайдет огранизационо техничесой группе, девопсам, участникам желающим провести свои тренировки 

## Описание функционала

- Развертывание одельного контейнера на каждого участника
- перезагрузка контейнера при возникновении ошибок участником
- полная остановка контейнера
- автоматическая остановка и удаления контейнера через опредененное время 
- возможность участника продлить время 'жизни' контейнера 

## Установка и настройка


### Требования

- сервер на базе `linux`
- на сервере должен стоять docker и docker compose
- сервер должен иметь такие параметры чтобы выдержал запуск n/2 контейнеров с вашей задачей, 
где n это колличество участников мероприятия 


### Установка

```bash
git clone https://github.com/d1temnd/ctf_easy_per_deploy.git 
cd ctf_easy_per_deploy
docker compose up --build -d 
```

web интерфейс который можно выдовать учасникам будет поднят на порту: 6664

### Пример настроек

## Подготовка задачи

В вашей задаче обязательно должен быть dockerfile

1. Регестрируемся на `hub.docker.com`
2. В папке задачи делаем `docker login` и вводим все необходимые данные 
3. Собираем проект `docker build -t <userName>/<conteiner_neme>:<version> .` 
4. Отправляем образ на докер хаб `docker image push <userName>/<conteiner_neme>:<version>`

```yaml
environment:
    - LEAVE_TIME = 1800 # Время жизни (сек)
    - ADD_TIME = 600 # Время добавки жизни (сек)
    - IMAGES_NAME = # Ваш докер образ на докер хабе 
    - PORT_IN_CONTAINER = <userName>/<conteiner_neme>:<version># порт на котором развернуто приложения в контейнере 
    - START_RANGE = 9000 # начало интервала свободных портов
    - STOP_RANGE = 10000 # конец интервала свободных портов 

```

## Инфраструктура

- в проекте есть API что позволяет упралять контейнерами дугими методами, и интегрировать в систему жури 
- для отслеживания состояния контейнера мы используем базу данных в которой храним индитификатор пользователя, id контейнера, время запукска контейнера в формате uxin-timestepmap, и время смери контейнера. 


